# Moonrepo Integration for GearMesh

GearMeshãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€Moonrepoã‚’ä½¿ç”¨ã—ã¦Rustãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã¨Node.jsãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ã‚’çµ±ä¸€çš„ã«ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚

## ğŸ“¦ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

Moonrepoã¯ä»¥ä¸‹ã®6ã¤ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èªè­˜ã—ã¾ã™ï¼š

```
GearMesh/
â”œâ”€â”€ GearMesh (root)              # Node.js tooling (Husky, Commitlint)
â””â”€â”€ crates/
    â”œâ”€â”€ gear-mesh-core           # ä¸­é–“è¡¨ç¾ï¼ˆIRï¼‰å±¤
    â”œâ”€â”€ gear-mesh-derive         # Proc-macroå±¤
    â”œâ”€â”€ gear-mesh-generator      # ã‚³ãƒ¼ãƒ‰ç”Ÿæˆå±¤
    â”œâ”€â”€ gear-mesh-cli            # CLIå±¤
    â””â”€â”€ gear-mesh                # çµ±åˆå±¤ï¼ˆãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ï¼‰
```

## ğŸš€ åŸºæœ¬çš„ãªä½¿ã„æ–¹

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ã®ç¢ºèª

```bash
moon query projects
```

### ç‰¹å®šã®ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ

```bash
# å˜ä¸€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ
moon run gear-mesh-core:test

# å˜ä¸€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰
moon run gear-mesh-cli:build

# å˜ä¸€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®lint
moon run gear-mesh-generator:lint
```

### å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§åŒã˜ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ

```bash
# å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ
moon run :test

# å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰
moon run :build

# å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®lint
moon run :lint
```

### ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹å…¨ä½“ã®ã‚¿ã‚¹ã‚¯

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
moon run GearMesh:test-all

# å…¨ãƒ“ãƒ«ãƒ‰
moon run GearMesh:build-all

# ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
moon run GearMesh:quality
```

### ä¾å­˜é–¢ä¿‚ã‚’å«ã‚ã¦å®Ÿè¡Œ

```bash
# gear-mesh-cliã¨ãã®ä¾å­˜é–¢ä¿‚ã‚’ãƒ“ãƒ«ãƒ‰
moon run gear-mesh-cli:build --affected
```

## ğŸ¯ ã‚¿ã‚¹ã‚¯å®šç¾©

å„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ï¼š

### Rustã‚¯ãƒ¬ãƒ¼ãƒˆå…±é€šã‚¿ã‚¹ã‚¯

- `build`: ã‚¯ãƒ¬ãƒ¼ãƒˆã‚’ãƒ“ãƒ«ãƒ‰
- `test`: ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
- `lint`: Clippyã§lint
- `format`: rustfmtã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯
- `doc`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ

### ãƒ«ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆNode.jsï¼‰ã‚¿ã‚¹ã‚¯

- `install`: npmä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- `setup-hooks`: Huskyãƒ•ãƒƒã‚¯ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- `lint-commit`: ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®lintï¼ˆCIç”¨ï¼‰
- `quality`: å…¨Rustã‚³ãƒ¼ãƒ‰ã®å“è³ªãƒã‚§ãƒƒã‚¯
- `test-all`: å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- `build-all`: å…¨ãƒ“ãƒ«ãƒ‰

## ğŸ“Š ä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•

Moonrepoã¯è‡ªå‹•çš„ã«ä¾å­˜é–¢ä¿‚ã‚’è§£æ±ºã—ã¾ã™ï¼š

```
gear-mesh-cli:build
  â†“
gear-mesh-generator:build
  â†“
gear-mesh-core:build

gear-mesh:build
  â†“
  â”œâ”€â†’ gear-mesh-core:build
  â”œâ”€â†’ gear-mesh-derive:build
  â””â”€â†’ gear-mesh-generator:build
```

## ğŸ”§ ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°

Moonrepoã¯ä»¥ä¸‹ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¾ã™ï¼š

- **ã‚¿ã‚¹ã‚¯å‡ºåŠ›**: ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã€ãƒ†ã‚¹ãƒˆçµæœ
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœŸé–“**: 7æ—¥é–“
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥å ´æ‰€**: `.moon/cache/`ï¼ˆgitignoreæ¸ˆã¿ï¼‰

ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãŠã‹ã’ã§ã€å¤‰æ›´ã®ãªã„ã‚¿ã‚¹ã‚¯ã¯å†å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚

## ğŸƒ CI/CDçµ±åˆ

GitHub Actionsã§ã®ä½¿ç”¨ä¾‹ï¼š

```yaml
- name: Setup Moonrepo
  uses: moonrepo/setup-toolchain@v0
  with:
    auto-install: true

- name: Run all tests
  run: moon run :test

- name: Run quality checks
  run: moon run GearMesh:quality
```

## ğŸ¨ åˆ©ç‚¹

### 1. **çµ±ä¸€ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯å®Ÿè¡Œ**
- Rustã¨Node.jsã‚’åŒã˜ã‚³ãƒãƒ³ãƒ‰ã§ç®¡ç†
- `cargo`ã¨`npm`ã‚’ç›´æ¥ä½¿ã†å¿…è¦ãŒãªã„

### 2. **ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°**
- å¤‰æ›´ã®ãªã„ã‚¿ã‚¹ã‚¯ã¯ã‚¹ã‚­ãƒƒãƒ—
- CIæ™‚é–“ã®å¤§å¹…ãªçŸ­ç¸®

### 3. **ä¾å­˜é–¢ä¿‚ã®è‡ªå‹•è§£æ±º**
- ã‚¿ã‚¹ã‚¯é–“ã®ä¾å­˜é–¢ä¿‚ã‚’è‡ªå‹•ã§å®Ÿè¡Œ
- æ­£ã—ã„é †åºã§ãƒ“ãƒ«ãƒ‰

### 4. **å‹å®‰å…¨ãªè¨­å®š**
- YAMLã«ã‚ˆã‚‹æ˜ç¤ºçš„ãªè¨­å®š
- ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼æ¤œå‡º

### 5. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–“ã®æ•´åˆæ€§**
- å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§çµ±ä¸€ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯å
- ä¸€è²«ã—ãŸé–‹ç™ºä½“é¨“

## ğŸ“ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

### `.moon/workspace.yml`
ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹å…¨ä½“ã®è¨­å®š

### `.moon/toolchain.yml`
ãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ï¼ˆNode.jsã€Rustã€TypeScriptï¼‰ã®è¨­å®š

### `moon.yml` (å„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ)
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®ã‚¿ã‚¹ã‚¯å®šç¾©

## ğŸ” ãƒ‡ãƒãƒƒã‚°

### ã‚¿ã‚¹ã‚¯ã®è©³ç´°ã‚’ç¢ºèª

```bash
moon query tasks gear-mesh-core
```

### ä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•ã‚’è¡¨ç¤º

```bash
moon project-graph
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢

```bash
moon clean
```

## å‚è€ƒãƒªãƒ³ã‚¯

- [Moonrepoå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://moonrepo.dev/docs)
- [Moonrepo GitHub](https://github.com/moonrepo/moon)
